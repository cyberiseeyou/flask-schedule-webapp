# Story 1.1: Project Setup and Dashboard View

## Status
Ready for Review

## Story
**As a** scheduler,
**I want** to run the application and see a prioritized list of all unscheduled events,
**so that** I have a clear and organized view of the work that needs to be done.

## Acceptance Criteria
1. A Flask application structure is created with required folders and files.
2. SQLAlchemy is configured and can connect to a local SQLite database file.
3. The Events, Employees, and Schedules database tables are created based on the data models.
4. When I navigate to the main dashboard (/), I see a list of all events where is_scheduled is False.
5. The list of events is correctly sorted first by start_date (ascending) and then by due_date (ascending).

## Tasks / Subtasks
- [x] Task 1: Setup Flask application structure (AC: 1)
  - [x] Create main app.py file
  - [x] Create requirements.txt with Flask, SQLAlchemy dependencies
  - [x] Create instance/ directory for database
  - [x] Create static/ directory with css/ and js/ subdirectories
  - [x] Create templates/ directory
- [x] Task 2: Configure SQLAlchemy and database connection (AC: 2)
  - [x] Initialize Flask app with SQLAlchemy configuration
  - [x] Configure SQLite database path to instance/scheduler.db
  - [x] Set up database initialization function
- [x] Task 3: Create database models (AC: 3)
  - [x] Implement Events model with all required fields
  - [x] Implement Employees model with id and name fields
  - [x] Implement Schedules model with foreign key relationships
  - [x] Create database tables with proper indexes
- [x] Task 4: Implement dashboard route and template (AC: 4, 5)
  - [x] Create main dashboard route (/)
  - [x] Query unscheduled events (is_scheduled=False)
  - [x] Sort events by start_date then due_date (ascending)
  - [x] Create index.html template with event list
  - [x] Style dashboard according to UI specification
- [x] Task 5: Testing implementation
  - [x] Write unit tests for database models
  - [x] Write integration tests for dashboard route
  - [x] Test database table creation and relationships

## Dev Notes

### Testing Standards
**Testing Framework**: Pytest 7.4+
**Test Location**: Tests should be created in project root or tests/ directory
**Test Standards**: 
- Unit tests for business logic and data models
- Integration tests for database interactions and API endpoints
- Follow testing pyramid approach
[Source: PRD.md#technical-assumptions]

### Data Models Specifications
Based on the architecture document, implement these exact models:

**Events Model:**
- id: Integer, Primary Key (auto-increment)
- project_name: String (from CSV Project Name)
- project_ref_num: Integer, Unique (from CSV Project Reference Number)
- location_mvid: String (from CSV Location MVID)
- store_number: Integer (from CSV Store Number)
- store_name: String (from CSV Store Name)
- start_datetime: DateTime (from CSV Start Date/Time)
- due_datetime: DateTime (from CSV Due Date/Time)
- estimated_time: Integer (from CSV Estimated Time)
- is_scheduled: Boolean (default: False)
[Source: Fullstack Architecture Document.md#data-models]

**Employees Model:**
- id: String, Primary Key (from CSV Employee ID)
- name: String (from CSV Rep Name)
[Source: Fullstack Architecture Document.md#data-models]

**Schedules Model:**
- id: Integer, Primary Key (auto-increment)
- event_ref_num: Integer, Foreign Key (Events.project_ref_num)
- employee_id: String, Foreign Key (Employees.id)
- schedule_datetime: DateTime (from CSV Schedule Date/Time)
[Source: Fullstack Architecture Document.md#data-models]

### Project Structure
Implement this exact structure:
```
/scheduler_app
├── app.py                  # Main Flask application file
├── requirements.txt        # Python dependencies
├── instance/
│   └── scheduler.db        # SQLite database file will be created here
├── static/
│   ├── css/
│   │   └── style.css       # Main stylesheet
│   └── js/
│       └── main.js         # Main JavaScript for interactivity
└── templates/
    ├── index.html          # Dashboard page
    └── schedule.html       # Scheduling page
```
[Source: Fullstack Architecture Document.md#unified-project-structure]

### Technology Stack
- **Backend Language**: Python 3.11+
- **Web Framework**: Flask 2.3+
- **Database ORM**: SQLAlchemy 2.0+
- **Database**: SQLite 3.3+
- **Frontend**: HTML5/CSS3, JavaScript (ES6+)
[Source: Fullstack Architecture Document.md#tech-stack]

### UI Specifications
**Dashboard Requirements:**
- Main Heading: "Unscheduled Events"
- Event list/table displaying:
  - Event Name (project_name)
  - Valid Date Range (start_date - due_date)
  - "Schedule" button for each event
- Color scheme: Primary #007BFF, Success #28A745, Error #DC3545, Neutral #F8F9FA/#6C757D/#212529
- Typography: H1 2.5rem/600, H2 2rem/600, Body 1rem/400, Sans-serif
[Source: UI_UX SPECIFICATION.md#key-screen-layouts]

### Database Schema
Use this exact SQL DDL:
```sql
CREATE TABLE employees (
    id VARCHAR(50) PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);

CREATE TABLE events (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    project_name TEXT NOT NULL,
    project_ref_num INTEGER NOT NULL UNIQUE,
    location_mvid TEXT,
    store_number INTEGER,
    store_name TEXT,
    start_datetime DATETIME NOT NULL,
    due_datetime DATETIME NOT NULL,
    estimated_time INTEGER,
    is_scheduled BOOLEAN NOT NULL DEFAULT 0
);

CREATE TABLE schedules (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    event_ref_num INTEGER NOT NULL,
    employee_id VARCHAR(50) NOT NULL,
    schedule_datetime DATETIME NOT NULL,
    FOREIGN KEY (event_ref_num) REFERENCES events (project_ref_num),
    FOREIGN KEY (employee_id) REFERENCES employees (id)
);

CREATE INDEX idx_schedules_date ON schedules (schedule_datetime);
```
[Source: Fullstack Architecture Document.md#database-schema]

### Functional Requirements
- **FR1**: Display unscheduled events on dashboard, sorted by start_date then due_date
- **NFR1**: Application runs locally via Python script
- **NFR2**: Use Flask web framework
- **NFR3**: Use SQLite with SQLAlchemy ORM
- **NFR4**: Frontend with standard HTML/CSS/JavaScript (no heavy frameworks)
[Source: PRD.md#requirements]

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-23 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References
- Fixed database path configuration in app.py using absolute paths
- Resolved SQLAlchemy compatibility issue with Python 3.13 by upgrading to Flask 3.0.0 and SQLAlchemy 2.0.36
- Created separate test configurations to avoid database path conflicts

### Completion Notes List
- All acceptance criteria successfully implemented and tested
- Flask application structure created following exact specification
- Database models implemented with proper relationships and indexes
- Dashboard displays unscheduled events sorted by start_date then due_date
- Comprehensive test suite with 100% pass rate (6 model tests + 4 route tests)
- Application successfully runs and serves dashboard at http://127.0.0.1:5000

### File List
**Source Files:**
- scheduler_app/app.py (Main Flask application)
- scheduler_app/requirements.txt (Python dependencies)
- scheduler_app/templates/index.html (Dashboard template)
- scheduler_app/templates/schedule.html (Future scheduling page)
- scheduler_app/static/css/style.css (Application styling)
- scheduler_app/static/js/main.js (Frontend interactivity)

**Test Files:**
- scheduler_app/test_models.py (Unit tests for database models)
- scheduler_app/test_routes.py (Integration tests for dashboard route)

**Database:**
- scheduler_app/instance/scheduler.db (SQLite database file)

## QA Results
*Results from QA Agent review will be populated here*