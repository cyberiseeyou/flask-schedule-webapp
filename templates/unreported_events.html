{% extends "base.html" %}

{% block title %}Unreported Events - Product Connections Scheduler{% endblock %}
{% block page_title %}Scheduler{% endblock %}

{% block extra_head %}
<style>
    .page-header {
        text-align: center;
        margin-bottom: var(--spacing-lg);
        padding-bottom: var(--spacing-md);
        border-bottom: 2px solid var(--pc-light-blue);
    }

    .page-title {
        font-size: var(--font-size-h1);
        font-weight: var(--font-weight-heading);
        color: var(--pc-navy);
        margin: 0;
        letter-spacing: -0.02em;
    }

    .page-subtitle {
        font-size: var(--font-size-small);
        color: var(--text-secondary);
        margin-top: var(--spacing-xs);
    }

    .events-table {
        width: 100%;
        border-collapse: collapse;
        background: var(--bg-primary);
        border-radius: var(--border-radius-md);
        overflow: hidden;
        box-shadow: var(--shadow-sm);
    }

    .events-table thead {
        background: var(--pc-navy);
        color: white;
    }

    .events-table th {
        padding: var(--spacing-md);
        text-align: left;
        font-weight: var(--font-weight-heading);
        font-size: var(--font-size-small);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .events-table tbody tr {
        border-bottom: 1px solid rgba(46, 76, 115, 0.1);
        transition: background-color 0.2s ease;
    }

    .events-table tbody tr:hover {
        background-color: var(--bg-secondary);
    }

    .events-table tbody tr:last-child {
        border-bottom: none;
    }

    .events-table td {
        padding: var(--spacing-md);
        vertical-align: top;
    }

    .event-name {
        font-weight: var(--font-weight-heading);
        color: var(--text-primary);
        margin-bottom: var(--spacing-xs);
    }

    .event-type {
        display: inline-block;
        padding: 2px 8px;
        border-radius: var(--border-radius-sm);
        font-size: 11px;
        font-weight: var(--font-weight-medium);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .event-type-core { background: #e3f2fd; color: #1565c0; }
    .event-type-supervisor { background: #f3e5f5; color: #6a1b9a; }
    .event-type-juicer { background: #fff3e0; color: #e65100; }
    .event-type-digital { background: #e8f5e9; color: #2e7d32; }
    .event-type-freeosk { background: #fce4ec; color: #c2185b; }
    .event-type-other { background: #f5f5f5; color: #616161; }

    .days-overdue {
        display: inline-block;
        padding: 4px 12px;
        border-radius: var(--border-radius-sm);
        font-weight: var(--font-weight-bold);
        font-size: var(--font-size-small);
    }

    .days-overdue-1-3 {
        background: #fff3cd;
        color: #856404;
    }

    .days-overdue-4-7 {
        background: #f8d7da;
        color: #721c24;
    }

    .days-overdue-8plus {
        background: #d32f2f;
        color: white;
    }

    .date-info {
        font-size: var(--font-size-small);
        color: var(--text-secondary);
    }

    .date-label {
        font-weight: var(--font-weight-medium);
        color: var(--text-primary);
    }

    .empty-state {
        text-align: center;
        padding: var(--spacing-xxl);
        color: var(--text-secondary);
    }

    .empty-state-icon {
        font-size: 48px;
        margin-bottom: var(--spacing-md);
        color: var(--pc-light-blue);
    }

    .empty-state-message {
        font-size: var(--font-size-body);
        margin-bottom: var(--spacing-sm);
    }

    .summary-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--spacing-md);
        background: var(--bg-secondary);
        border-radius: var(--border-radius-md);
        margin-bottom: var(--spacing-lg);
    }

    .summary-count {
        font-size: var(--font-size-h3);
        font-weight: var(--font-weight-bold);
        color: var(--pc-navy);
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Unreported Events</h1>
    <p class="page-subtitle">Events from the last 2 weeks that need to be reported</p>
</div>

{% if total_count > 0 %}
<div class="summary-bar">
    <div class="summary-count">{{ total_count }} event{{ 's' if total_count != 1 else '' }} pending report</div>
</div>

<table class="events-table">
    <thead>
        <tr>
            <th>Event Details</th>
            <th>Scheduled Employee</th>
            <th>Scheduled Date & Time</th>
            <th>Event Period</th>
            <th>Days Overdue</th>
        </tr>
    </thead>
    <tbody>
        {% for item in unreported_events %}
        <tr>
            <td>
                <div class="event-name">{{ item.event.project_name }}</div>
                <span class="event-type event-type-{{ item.event.event_type.lower().replace(' ', '-') }}">
                    {{ item.event.event_type }}
                </span>
            </td>
            <td>
                <strong>{{ item.employee.name }}</strong>
            </td>
            <td>
                <div><span class="date-label">Date:</span> {{ item.schedule_date.strftime('%m/%d/%Y') }}</div>
                <div class="date-info">{{ item.schedule_time }}</div>
            </td>
            <td>
                <div><span class="date-label">Start:</span> {{ item.event.start_datetime.strftime('%m/%d/%Y') }}</div>
                <div><span class="date-label">Due:</span> {{ item.event.due_datetime.strftime('%m/%d/%Y') }}</div>
            </td>
            <td>
                {% if item.days_overdue <= 3 %}
                <span class="days-overdue days-overdue-1-3">{{ item.days_overdue }} day{{ 's' if item.days_overdue != 1 else '' }}</span>
                {% elif item.days_overdue <= 7 %}
                <span class="days-overdue days-overdue-4-7">{{ item.days_overdue }} days</span>
                {% else %}
                <span class="days-overdue days-overdue-8plus">{{ item.days_overdue }} days</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% else %}
<div class="empty-state">
    <div class="empty-state-icon">âœ“</div>
    <div class="empty-state-message">All events from the last 2 weeks have been reported!</div>
    <p class="date-info">No unreported events found.</p>
</div>
{% endif %}

{% endblock %}
